<?php

declare(strict_types=1);

/**
 * ShipmentsApi
 * PHP version 7.2
 *
 * @category Class
 * @package  Toppy\Sendcloud
 * @author   OpenAPI Generator team
 * @link     https://openapi-generator.tech
 */
/**
 * Sendcloud Public REST API
 *
 * Complete Sendcloud API v2 specification - merged from official Stoplight documentation bundles
 *
 * The version of the OpenAPI document: 3.0.0
 * Contact: contact@sendcloud.com
 * Generated by: https://openapi-generator.tech
 * Generator version: 7.18.0
 */
/**
 * NOTE: This class is auto generated by OpenAPI Generator (https://openapi-generator.tech).
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */
namespace Toppy\Sendcloud\Api;

use GuzzleHttp\Psr7\MultipartStream;
use Http\Client\Common\Plugin\ErrorPlugin;
use Http\Client\Common\Plugin\RedirectPlugin;
use Http\Client\Common\PluginClient;
use Http\Client\Common\PluginClientFactory;
use Http\Client\Exception\HttpException;
use Http\Client\HttpAsyncClient;
use Http\Discovery\HttpAsyncClientDiscovery;
use Http\Discovery\Psr17FactoryDiscovery;
use Http\Discovery\Psr18ClientDiscovery;
use Http\Message\RequestFactory;
use Http\Promise\Promise;
use Toppy\Sendcloud\ApiException;
use Toppy\Sendcloud\Configuration;
use Toppy\Sendcloud\DebugPlugin;
use Toppy\Sendcloud\HeaderSelector;
use Toppy\Sendcloud\FormDataProcessor;
use Toppy\Sendcloud\ObjectSerializer;
use Psr\Http\Client\ClientExceptionInterface;
use Psr\Http\Client\ClientInterface;
use Psr\Http\Message\RequestFactoryInterface;
use Psr\Http\Message\RequestInterface;
use Psr\Http\Message\ResponseInterface;
use Psr\Http\Message\StreamFactoryInterface;
use Psr\Http\Message\UriFactoryInterface;
use Psr\Http\Message\UriInterface;
use function sprintf;

/**
 * ShipmentsApi Class Doc Comment
 *
 * @category Class
 * @package  Toppy\Sendcloud
 * @author   OpenAPI Generator team
 * @link     https://openapi-generator.tech
 */
class ShipmentsApi
{
    /**
     * @var PluginClient
     */
    protected $httpClient;

    /**
     * @var PluginClient
     */
    protected $httpAsyncClient;

    /**
     * @var UriFactoryInterface
     */
    protected $uriFactory;

    /**
     * @var Configuration
     */
    protected $config;

    /**
     * @var RequestFactoryInterface
     */
    protected $requestFactory;

    /**
     * @var StreamFactoryInterface
     */
    protected $streamFactory;

    /**
     * @param int $hostIndex
     */
    public function __construct(
        ?ClientInterface $httpClient = null,
        ?Configuration $configuration = null,
        ?HttpAsyncClient $httpAsyncClient = null,
        ?UriFactoryInterface $uriFactory = null,
        ?RequestFactoryInterface $requestFactory = null,
        ?StreamFactoryInterface $streamFactory = null,
        protected ?HeaderSelector $headerSelector = new HeaderSelector(),
        ?array $plugins = null,
        /**
         * @var int Host index
         */
        protected $hostIndex = 0
    ) {
        $this->config = $configuration ?? (new Configuration())->setHost('https://account.sendcloud.com');
        $this->requestFactory = $requestFactory ?? Psr17FactoryDiscovery::findRequestFactory();
        $this->streamFactory = $streamFactory ?? Psr17FactoryDiscovery::findStreamFactory();

        $plugins = $plugins ?? [
            new RedirectPlugin(['strict' => true]),
            new ErrorPlugin(),
        ];

        if ($this->config->getDebug()) {
            $plugins[] = new DebugPlugin(fopen($this->config->getDebugFile(), 'ab'));
        }

        $this->httpClient = (new PluginClientFactory())->createClient(
            $httpClient ?? Psr18ClientDiscovery::find(),
            $plugins
        );

        $this->httpAsyncClient = (new PluginClientFactory())->createClient(
            $httpAsyncClient ?? HttpAsyncClientDiscovery::find(),
            $plugins
        );

        $this->uriFactory = $uriFactory ?? Psr17FactoryDiscovery::findUriFactory();
    }

    /**
     * Set the host index
     *
     * @param int $hostIndex Host index (required)
     */
    public function setHostIndex($hostIndex): void
    {
        $this->hostIndex = $hostIndex;
    }

    /**
     * Get the host index
     *
     * @return int Host index
     */
    public function getHostIndex()
    {
        return $this->hostIndex;
    }

    /**
     * @return Configuration
     */
    public function getConfig()
    {
        return $this->config;
    }

    /**
     * Operation scPublicV2OrdersGetRetrieveAListOfShipments
     *
     * Retrieve a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  string $cursor The cursor query string will be used as the pivot value to filter results. If no value is provided, the service must return the first page. The value is Base64 encoded GET parameters. example:   For a cursor string there are 3 possible parameters to encode:   - o: Offset   - r: Reverse   - p: Position   Combine into GET parameters. Example: r&#x3D;1&amp;p&#x3D;300   Base 64 encoded it would become: cj0xJnA9MzAw   GET parameter in url would be https://some.url.com/api/endpoint/?cursor&#x3D;cj0xJnA9MzAw (optional)
     * @param  \DateTime $startDate Displays orders from the given &#x60;start_date&#x60;, including the set date. It defaults to one year ago. (optional)
     * @param  \DateTime $endDate Displays orders up to the given &#x60;end_date&#x60;, including the set date. It defaults to the current date. (optional)
     * @param  string[] $externalOrderIds Filters results to shipments where their &#x60;external_order_id&#x60; matches one of the user provided ones. (optional)
     * @param  string[] $externalShipmentIds Filters results to shipments where their &#x60;external_shipments_id&#x60; matches one of the user provided ones. (optional)
     * @param  bool $shippingRules Enable shipping rules when retrieving orders. This will have an impact on the &#x60;allowed_shipping_methods&#x60;. (optional)
     * @param  string $orderNumber Filters results to shipments on &#x60;order_number&#x60;. (optional)
     * @param  int $senderAddress Allows to specify a sender address id to display proper &#x60;allowed_shipping_methods&#x60;. (optional)
     *
     * @throws \Toppy\Sendcloud\ApiException on non-2xx response
     * @throws \InvalidArgumentException
     * @return \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments200Response|\Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response
     */
    public function scPublicV2OrdersGetRetrieveAListOfShipments($id, $cursor = null, $startDate = null, $endDate = null, $externalOrderIds = null, $externalShipmentIds = null, $shippingRules = null, $orderNumber = null, $senderAddress = null)
    {
        [$response] = $this->scPublicV2OrdersGetRetrieveAListOfShipmentsWithHttpInfo($id, $cursor, $startDate, $endDate, $externalOrderIds, $externalShipmentIds, $shippingRules, $orderNumber, $senderAddress);
        return $response;
    }

    /**
     * Operation scPublicV2OrdersGetRetrieveAListOfShipmentsWithHttpInfo
     *
     * Retrieve a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  string $cursor The cursor query string will be used as the pivot value to filter results. If no value is provided, the service must return the first page. The value is Base64 encoded GET parameters. example:   For a cursor string there are 3 possible parameters to encode:   - o: Offset   - r: Reverse   - p: Position   Combine into GET parameters. Example: r&#x3D;1&amp;p&#x3D;300   Base 64 encoded it would become: cj0xJnA9MzAw   GET parameter in url would be https://some.url.com/api/endpoint/?cursor&#x3D;cj0xJnA9MzAw (optional)
     * @param  \DateTime $startDate Displays orders from the given &#x60;start_date&#x60;, including the set date. It defaults to one year ago. (optional)
     * @param  \DateTime $endDate Displays orders up to the given &#x60;end_date&#x60;, including the set date. It defaults to the current date. (optional)
     * @param  string[] $externalOrderIds Filters results to shipments where their &#x60;external_order_id&#x60; matches one of the user provided ones. (optional)
     * @param  string[] $externalShipmentIds Filters results to shipments where their &#x60;external_shipments_id&#x60; matches one of the user provided ones. (optional)
     * @param  bool $shippingRules Enable shipping rules when retrieving orders. This will have an impact on the &#x60;allowed_shipping_methods&#x60;. (optional)
     * @param  string $orderNumber Filters results to shipments on &#x60;order_number&#x60;. (optional)
     * @param  int $senderAddress Allows to specify a sender address id to display proper &#x60;allowed_shipping_methods&#x60;. (optional)
     *
     * @throws \Toppy\Sendcloud\ApiException on non-2xx response
     * @throws \InvalidArgumentException
     * @return array of \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments200Response|\Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response, HTTP status code, HTTP response headers (array of strings)
     */
    public function scPublicV2OrdersGetRetrieveAListOfShipmentsWithHttpInfo($id, $cursor = null, $startDate = null, $endDate = null, $externalOrderIds = null, $externalShipmentIds = null, $shippingRules = null, $orderNumber = null, $senderAddress = null)
    {
        $request = $this->scPublicV2OrdersGetRetrieveAListOfShipmentsRequest($id, $cursor, $startDate, $endDate, $externalOrderIds, $externalShipmentIds, $shippingRules, $orderNumber, $senderAddress);

        try {
            try {
                $response = $this->httpClient->sendRequest($request);
            } catch (HttpException $e) {
                $response = $e->getResponse();
                throw new ApiException(
                    sprintf(
                        '[%d] Error connecting to the API (%s)',
                        $response->getStatusCode(),
                        (string) $request->getUri()
                    ),
                    $request,
                    $response,
                    $e
                );
            } catch (ClientExceptionInterface $e) {
                throw new ApiException(
                    sprintf('[%d] %s', $e->getCode(), $e->getMessage()),
                    $request,
                    null,
                    $e
                );
            }

            $statusCode = $response->getStatusCode();


            switch($statusCode) {
                case 200:
                    return $this->handleResponseWithDataType(
                        \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments200Response::class,
                        $request,
                        $response,
                    );
                case 404:
                    return $this->handleResponseWithDataType(
                        \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response::class,
                        $request,
                        $response,
                    );
            }

            

            if ($statusCode < 200 || $statusCode > 299) {
                throw new ApiException(
                    sprintf(
                        '[%d] Error connecting to the API (%s)',
                        $statusCode,
                        (string) $request->getUri()
                    ),
                    $request,
                    $response
                );
            }

            return $this->handleResponseWithDataType(
                \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments200Response::class,
                $request,
                $response,
            );
        } catch (ApiException $apiException) {
            switch ($apiException->getCode()) {
                case 200:
                    $data = ObjectSerializer::deserialize(
                        $apiException->getResponseBody(),
                        \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments200Response::class,
                        $apiException->getResponseHeaders()
                    );
                    $apiException->setResponseObject($data);
                    throw $apiException;
                case 404:
                    $data = ObjectSerializer::deserialize(
                        $apiException->getResponseBody(),
                        \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response::class,
                        $apiException->getResponseHeaders()
                    );
                    $apiException->setResponseObject($data);
                    throw $apiException;
            }
        

            throw $apiException;
        }
    }

    /**
     * Operation scPublicV2OrdersGetRetrieveAListOfShipmentsAsync
     *
     * Retrieve a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  string $cursor The cursor query string will be used as the pivot value to filter results. If no value is provided, the service must return the first page. The value is Base64 encoded GET parameters. example:   For a cursor string there are 3 possible parameters to encode:   - o: Offset   - r: Reverse   - p: Position   Combine into GET parameters. Example: r&#x3D;1&amp;p&#x3D;300   Base 64 encoded it would become: cj0xJnA9MzAw   GET parameter in url would be https://some.url.com/api/endpoint/?cursor&#x3D;cj0xJnA9MzAw (optional)
     * @param  \DateTime $startDate Displays orders from the given &#x60;start_date&#x60;, including the set date. It defaults to one year ago. (optional)
     * @param  \DateTime $endDate Displays orders up to the given &#x60;end_date&#x60;, including the set date. It defaults to the current date. (optional)
     * @param  string[] $externalOrderIds Filters results to shipments where their &#x60;external_order_id&#x60; matches one of the user provided ones. (optional)
     * @param  string[] $externalShipmentIds Filters results to shipments where their &#x60;external_shipments_id&#x60; matches one of the user provided ones. (optional)
     * @param  bool $shippingRules Enable shipping rules when retrieving orders. This will have an impact on the &#x60;allowed_shipping_methods&#x60;. (optional)
     * @param  string $orderNumber Filters results to shipments on &#x60;order_number&#x60;. (optional)
     * @param  int $senderAddress Allows to specify a sender address id to display proper &#x60;allowed_shipping_methods&#x60;. (optional)
     *
     * @throws \InvalidArgumentException
     * @return Promise
     */
    public function scPublicV2OrdersGetRetrieveAListOfShipmentsAsync($id, $cursor = null, $startDate = null, $endDate = null, $externalOrderIds = null, $externalShipmentIds = null, $shippingRules = null, $orderNumber = null, $senderAddress = null)
    {
        return $this->scPublicV2OrdersGetRetrieveAListOfShipmentsAsyncWithHttpInfo($id, $cursor, $startDate, $endDate, $externalOrderIds, $externalShipmentIds, $shippingRules, $orderNumber, $senderAddress)
            ->then(
                function ($response) {
                    return $response[0];
                }
            );
    }

    /**
     * Operation scPublicV2OrdersGetRetrieveAListOfShipmentsAsyncWithHttpInfo
     *
     * Retrieve a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  string $cursor The cursor query string will be used as the pivot value to filter results. If no value is provided, the service must return the first page. The value is Base64 encoded GET parameters. example:   For a cursor string there are 3 possible parameters to encode:   - o: Offset   - r: Reverse   - p: Position   Combine into GET parameters. Example: r&#x3D;1&amp;p&#x3D;300   Base 64 encoded it would become: cj0xJnA9MzAw   GET parameter in url would be https://some.url.com/api/endpoint/?cursor&#x3D;cj0xJnA9MzAw (optional)
     * @param  \DateTime $startDate Displays orders from the given &#x60;start_date&#x60;, including the set date. It defaults to one year ago. (optional)
     * @param  \DateTime $endDate Displays orders up to the given &#x60;end_date&#x60;, including the set date. It defaults to the current date. (optional)
     * @param  string[] $externalOrderIds Filters results to shipments where their &#x60;external_order_id&#x60; matches one of the user provided ones. (optional)
     * @param  string[] $externalShipmentIds Filters results to shipments where their &#x60;external_shipments_id&#x60; matches one of the user provided ones. (optional)
     * @param  bool $shippingRules Enable shipping rules when retrieving orders. This will have an impact on the &#x60;allowed_shipping_methods&#x60;. (optional)
     * @param  string $orderNumber Filters results to shipments on &#x60;order_number&#x60;. (optional)
     * @param  int $senderAddress Allows to specify a sender address id to display proper &#x60;allowed_shipping_methods&#x60;. (optional)
     *
     * @throws \InvalidArgumentException
     * @return Promise
     */
    public function scPublicV2OrdersGetRetrieveAListOfShipmentsAsyncWithHttpInfo($id, $cursor = null, $startDate = null, $endDate = null, $externalOrderIds = null, $externalShipmentIds = null, $shippingRules = null, $orderNumber = null, $senderAddress = null)
    {
        $returnType = \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments200Response::class;
        $request = $this->scPublicV2OrdersGetRetrieveAListOfShipmentsRequest($id, $cursor, $startDate, $endDate, $externalOrderIds, $externalShipmentIds, $shippingRules, $orderNumber, $senderAddress);

        return $this->httpAsyncClient->sendAsyncRequest($request)
            ->then(
                function ($response) use ($returnType) {
                    if ($returnType === '\SplFileObject') {
                        $content = $response->getBody(); //stream goes to serializer
                    } else {
                        $content = (string) $response->getBody();
                    }

                    return [
                        ObjectSerializer::deserialize($content, $returnType, []),
                        $response->getStatusCode(),
                        $response->getHeaders()
                    ];
                },
                function (HttpException $httpException) {
                    $response = $httpException->getResponse();
                    $statusCode = $response->getStatusCode();
                    throw new ApiException(
                        sprintf(
                            '[%d] Error connecting to the API (%s)',
                            $statusCode,
                            $httpException->getRequest()->getUri()
                        ),
                        $httpException->getRequest(),
                        $httpException->getResponse(),
                        $httpException
                    );
                }
            );
    }

    /**
     * Create request for operation 'scPublicV2OrdersGetRetrieveAListOfShipments'
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  string $cursor The cursor query string will be used as the pivot value to filter results. If no value is provided, the service must return the first page. The value is Base64 encoded GET parameters. example:   For a cursor string there are 3 possible parameters to encode:   - o: Offset   - r: Reverse   - p: Position   Combine into GET parameters. Example: r&#x3D;1&amp;p&#x3D;300   Base 64 encoded it would become: cj0xJnA9MzAw   GET parameter in url would be https://some.url.com/api/endpoint/?cursor&#x3D;cj0xJnA9MzAw (optional)
     * @param  \DateTime $startDate Displays orders from the given &#x60;start_date&#x60;, including the set date. It defaults to one year ago. (optional)
     * @param  \DateTime $endDate Displays orders up to the given &#x60;end_date&#x60;, including the set date. It defaults to the current date. (optional)
     * @param  string[] $externalOrderIds Filters results to shipments where their &#x60;external_order_id&#x60; matches one of the user provided ones. (optional)
     * @param  string[] $externalShipmentIds Filters results to shipments where their &#x60;external_shipments_id&#x60; matches one of the user provided ones. (optional)
     * @param  bool $shippingRules Enable shipping rules when retrieving orders. This will have an impact on the &#x60;allowed_shipping_methods&#x60;. (optional)
     * @param  string $orderNumber Filters results to shipments on &#x60;order_number&#x60;. (optional)
     * @param  int $senderAddress Allows to specify a sender address id to display proper &#x60;allowed_shipping_methods&#x60;. (optional)
     *
     * @throws \InvalidArgumentException
     * @return RequestInterface
     */
    public function scPublicV2OrdersGetRetrieveAListOfShipmentsRequest($id, $cursor = null, $startDate = null, $endDate = null, $externalOrderIds = null, $externalShipmentIds = null, $shippingRules = null, $orderNumber = null, $senderAddress = null)
    {
        // verify the required parameter 'id' is set
        if ($id === null || (is_array($id) && $id === [])) {
            throw new \InvalidArgumentException(
                'Missing the required parameter $id when calling scPublicV2OrdersGetRetrieveAListOfShipments'
            );
        }

        $resourcePath = '/integrations/{id}/shipments';
        $formParams = [];
        $queryParams = [];
        $headerParams = [];
        $httpBody = null;
        $multipart = false;

        // query params
        if ($cursor !== null) {
            if(is_array($cursor)) {
                foreach($cursor as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['cursor'] = $cursor;
            }
        }

        // query params
        if ($startDate !== null) {
            if(is_array($startDate)) {
                foreach($startDate as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['start_date'] = $startDate;
            }
        }

        // query params
        if ($endDate !== null) {
            if(is_array($endDate)) {
                foreach($endDate as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['end_date'] = $endDate;
            }
        }

        // query params
        if ($externalOrderIds !== null) {
            if(is_array($externalOrderIds)) {
                foreach($externalOrderIds as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['external_order_ids'] = $externalOrderIds;
            }
        }

        // query params
        if ($externalShipmentIds !== null) {
            if(is_array($externalShipmentIds)) {
                foreach($externalShipmentIds as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['external_shipment_ids'] = $externalShipmentIds;
            }
        }

        // query params
        if ($shippingRules !== null) {
            if(is_array($shippingRules)) {
                foreach($shippingRules as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['shipping_rules'] = $shippingRules;
            }
        }

        // query params
        if ($orderNumber !== null) {
            if(is_array($orderNumber)) {
                foreach($orderNumber as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['order_number'] = $orderNumber;
            }
        }

        // query params
        if ($senderAddress !== null) {
            if(is_array($senderAddress)) {
                foreach($senderAddress as $key => $value) {
                    $queryParams[$key] = $value;
                }
            }
            else {
                $queryParams['sender_address'] = $senderAddress;
            }
        }


        // path params
        $resourcePath = str_replace(
            '{id}',
            ObjectSerializer::toPathValue($id),
            $resourcePath
        );


        $headers = $this->headerSelector->selectHeaders(
            ['application/json'],
            '',
            $multipart
        );

        // for model (json/xml)
        if ($formParams !== []) {
            if ($multipart) {
                $multipartContents = [];
                foreach ($formParams as $formParamName => $formParamValue) {
                    $formParamValueItems = is_array($formParamValue) ? $formParamValue : [$formParamValue];
                    foreach ($formParamValueItems as $formParamValueItem) {
                        $multipartContents[] = [
                            'name' => $formParamName,
                            'contents' => $formParamValueItem
                        ];
                    }
                }

                // for HTTP post (form)
                $httpBody = new MultipartStream($multipartContents);

            } elseif ($this->headerSelector->isJsonMime($headers['Content-Type'])) {
                $httpBody = json_encode($formParams);

            } else {
                // for HTTP post (form)
                $httpBody = ObjectSerializer::buildQuery($formParams);
            }
        }

        // this endpoint requires HTTP basic authentication
        if (!empty($this->config->getUsername()) || !(empty($this->config->getPassword()))) {
            $headers['Authorization'] = 'Basic ' . base64_encode($this->config->getUsername() . ":" . $this->config->getPassword());
        }

        $defaultHeaders = [];
        if ($this->config->getUserAgent()) {
            $defaultHeaders['User-Agent'] = $this->config->getUserAgent();
        }

        $headers = array_merge(
            $defaultHeaders,
            $headerParams,
            $headers
        );

        $operationHost = $this->config->getHost();

        $uri = $this->createUri($operationHost, $resourcePath, $queryParams);

        return $this->createRequest('GET', $uri, $headers, $httpBody);
    }

    /**
     * Operation scPublicV2OrdersPostCreateAListOfShipments
     *
     * Create or update a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ShipmentBlobOrderCreate[] $shipmentBlobOrderCreate  (optional)
     *
     * @throws \Toppy\Sendcloud\ApiException on non-2xx response
     * @throws \InvalidArgumentException
     * @return \Toppy\Sendcloud\Model\ScPublicV2OrdersPostCreateAListOfShipments200ResponseInner[]|\Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response
     */
    public function scPublicV2OrdersPostCreateAListOfShipments($id, $shipmentBlobOrderCreate = null)
    {
        [$response] = $this->scPublicV2OrdersPostCreateAListOfShipmentsWithHttpInfo($id, $shipmentBlobOrderCreate);
        return $response;
    }

    /**
     * Operation scPublicV2OrdersPostCreateAListOfShipmentsWithHttpInfo
     *
     * Create or update a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ShipmentBlobOrderCreate[] $shipmentBlobOrderCreate  (optional)
     *
     * @throws \Toppy\Sendcloud\ApiException on non-2xx response
     * @throws \InvalidArgumentException
     * @return array of \Toppy\Sendcloud\Model\ScPublicV2OrdersPostCreateAListOfShipments200ResponseInner[]|\Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response, HTTP status code, HTTP response headers (array of strings)
     */
    public function scPublicV2OrdersPostCreateAListOfShipmentsWithHttpInfo($id, $shipmentBlobOrderCreate = null)
    {
        $request = $this->scPublicV2OrdersPostCreateAListOfShipmentsRequest($id, $shipmentBlobOrderCreate);

        try {
            try {
                $response = $this->httpClient->sendRequest($request);
            } catch (HttpException $e) {
                $response = $e->getResponse();
                throw new ApiException(
                    sprintf(
                        '[%d] Error connecting to the API (%s)',
                        $response->getStatusCode(),
                        (string) $request->getUri()
                    ),
                    $request,
                    $response,
                    $e
                );
            } catch (ClientExceptionInterface $e) {
                throw new ApiException(
                    sprintf('[%d] %s', $e->getCode(), $e->getMessage()),
                    $request,
                    null,
                    $e
                );
            }

            $statusCode = $response->getStatusCode();


            switch($statusCode) {
                case 200:
                    return $this->handleResponseWithDataType(
                        '\Toppy\Sendcloud\Model\ScPublicV2OrdersPostCreateAListOfShipments200ResponseInner[]',
                        $request,
                        $response,
                    );
                case 404:
                    return $this->handleResponseWithDataType(
                        \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response::class,
                        $request,
                        $response,
                    );
            }

            

            if ($statusCode < 200 || $statusCode > 299) {
                throw new ApiException(
                    sprintf(
                        '[%d] Error connecting to the API (%s)',
                        $statusCode,
                        (string) $request->getUri()
                    ),
                    $request,
                    $response
                );
            }

            return $this->handleResponseWithDataType(
                '\Toppy\Sendcloud\Model\ScPublicV2OrdersPostCreateAListOfShipments200ResponseInner[]',
                $request,
                $response,
            );
        } catch (ApiException $apiException) {
            switch ($apiException->getCode()) {
                case 200:
                    $data = ObjectSerializer::deserialize(
                        $apiException->getResponseBody(),
                        '\Toppy\Sendcloud\Model\ScPublicV2OrdersPostCreateAListOfShipments200ResponseInner[]',
                        $apiException->getResponseHeaders()
                    );
                    $apiException->setResponseObject($data);
                    throw $apiException;
                case 404:
                    $data = ObjectSerializer::deserialize(
                        $apiException->getResponseBody(),
                        \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response::class,
                        $apiException->getResponseHeaders()
                    );
                    $apiException->setResponseObject($data);
                    throw $apiException;
            }
        

            throw $apiException;
        }
    }

    /**
     * Operation scPublicV2OrdersPostCreateAListOfShipmentsAsync
     *
     * Create or update a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ShipmentBlobOrderCreate[] $shipmentBlobOrderCreate  (optional)
     *
     * @throws \InvalidArgumentException
     * @return Promise
     */
    public function scPublicV2OrdersPostCreateAListOfShipmentsAsync($id, $shipmentBlobOrderCreate = null)
    {
        return $this->scPublicV2OrdersPostCreateAListOfShipmentsAsyncWithHttpInfo($id, $shipmentBlobOrderCreate)
            ->then(
                function ($response) {
                    return $response[0];
                }
            );
    }

    /**
     * Operation scPublicV2OrdersPostCreateAListOfShipmentsAsyncWithHttpInfo
     *
     * Create or update a list of shipments
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ShipmentBlobOrderCreate[] $shipmentBlobOrderCreate  (optional)
     *
     * @throws \InvalidArgumentException
     * @return Promise
     */
    public function scPublicV2OrdersPostCreateAListOfShipmentsAsyncWithHttpInfo($id, $shipmentBlobOrderCreate = null)
    {
        $returnType = '\Toppy\Sendcloud\Model\ScPublicV2OrdersPostCreateAListOfShipments200ResponseInner[]';
        $request = $this->scPublicV2OrdersPostCreateAListOfShipmentsRequest($id, $shipmentBlobOrderCreate);

        return $this->httpAsyncClient->sendAsyncRequest($request)
            ->then(
                function ($response) use ($returnType) {
                    if ($returnType === '\SplFileObject') {
                        $content = $response->getBody(); //stream goes to serializer
                    } else {
                        $content = (string) $response->getBody();
                    }

                    return [
                        ObjectSerializer::deserialize($content, $returnType, []),
                        $response->getStatusCode(),
                        $response->getHeaders()
                    ];
                },
                function (HttpException $httpException) {
                    $response = $httpException->getResponse();
                    $statusCode = $response->getStatusCode();
                    throw new ApiException(
                        sprintf(
                            '[%d] Error connecting to the API (%s)',
                            $statusCode,
                            $httpException->getRequest()->getUri()
                        ),
                        $httpException->getRequest(),
                        $httpException->getResponse(),
                        $httpException
                    );
                }
            );
    }

    /**
     * Create request for operation 'scPublicV2OrdersPostCreateAListOfShipments'
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ShipmentBlobOrderCreate[] $shipmentBlobOrderCreate  (optional)
     *
     * @throws \InvalidArgumentException
     * @return RequestInterface
     */
    public function scPublicV2OrdersPostCreateAListOfShipmentsRequest($id, $shipmentBlobOrderCreate = null)
    {
        // verify the required parameter 'id' is set
        if ($id === null || (is_array($id) && $id === [])) {
            throw new \InvalidArgumentException(
                'Missing the required parameter $id when calling scPublicV2OrdersPostCreateAListOfShipments'
            );
        }

        $resourcePath = '/integrations/{id}/shipments';
        $formParams = [];
        $queryParams = [];
        $headerParams = [];
        $httpBody = null;
        $multipart = false;



        // path params
        $resourcePath = str_replace(
            '{id}',
            ObjectSerializer::toPathValue($id),
            $resourcePath
        );


        $headers = $this->headerSelector->selectHeaders(
            ['application/json'],
            'application/json',
            $multipart
        );

        // for model (json/xml)
        if (isset($shipmentBlobOrderCreate)) {
            if ($this->headerSelector->isJsonMime($headers['Content-Type'])) {
                $httpBody = json_encode(ObjectSerializer::sanitizeForSerialization($shipmentBlobOrderCreate));
            } else {
                $httpBody = $shipmentBlobOrderCreate;
            }
        } elseif ($formParams !== []) {
            if ($multipart) {
                $multipartContents = [];
                foreach ($formParams as $formParamName => $formParamValue) {
                    $formParamValueItems = is_array($formParamValue) ? $formParamValue : [$formParamValue];
                    foreach ($formParamValueItems as $formParamValueItem) {
                        $multipartContents[] = [
                            'name' => $formParamName,
                            'contents' => $formParamValueItem
                        ];
                    }
                }

                // for HTTP post (form)
                $httpBody = new MultipartStream($multipartContents);

            } elseif ($this->headerSelector->isJsonMime($headers['Content-Type'])) {
                $httpBody = json_encode($formParams);

            } else {
                // for HTTP post (form)
                $httpBody = ObjectSerializer::buildQuery($formParams);
            }
        }

        // this endpoint requires HTTP basic authentication
        if (!empty($this->config->getUsername()) || !(empty($this->config->getPassword()))) {
            $headers['Authorization'] = 'Basic ' . base64_encode($this->config->getUsername() . ":" . $this->config->getPassword());
        }

        $defaultHeaders = [];
        if ($this->config->getUserAgent()) {
            $defaultHeaders['User-Agent'] = $this->config->getUserAgent();
        }

        $headers = array_merge(
            $defaultHeaders,
            $headerParams,
            $headers
        );

        $operationHost = $this->config->getHost();

        $uri = $this->createUri($operationHost, $resourcePath, $queryParams);

        return $this->createRequest('POST', $uri, $headers, $httpBody);
    }

    /**
     * Operation scPublicV2OrdersPostDeleteAShipment
     *
     * Delete a shipment
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ScPublicV2OrdersPostDeleteAShipmentRequest $scPublicV2OrdersPostDeleteAShipmentRequest You must provide either a shipment_uuid or the combination of external_order_id and external_shipment_id to this endpoint. (optional)
     *
     * @throws \Toppy\Sendcloud\ApiException on non-2xx response
     * @throws \InvalidArgumentException
     * @return void
     */
    public function scPublicV2OrdersPostDeleteAShipment($id, $scPublicV2OrdersPostDeleteAShipmentRequest = null)
    {
        $this->scPublicV2OrdersPostDeleteAShipmentWithHttpInfo($id, $scPublicV2OrdersPostDeleteAShipmentRequest);
    }

    /**
     * Operation scPublicV2OrdersPostDeleteAShipmentWithHttpInfo
     *
     * Delete a shipment
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ScPublicV2OrdersPostDeleteAShipmentRequest $scPublicV2OrdersPostDeleteAShipmentRequest You must provide either a shipment_uuid or the combination of external_order_id and external_shipment_id to this endpoint. (optional)
     *
     * @throws \Toppy\Sendcloud\ApiException on non-2xx response
     * @throws \InvalidArgumentException
     * @return array<int, int|string[][]|null> of null, HTTP status code, HTTP response headers (array of strings)
     */
    public function scPublicV2OrdersPostDeleteAShipmentWithHttpInfo($id, $scPublicV2OrdersPostDeleteAShipmentRequest = null)
    {
        $request = $this->scPublicV2OrdersPostDeleteAShipmentRequest($id, $scPublicV2OrdersPostDeleteAShipmentRequest);

        try {
            try {
                $response = $this->httpClient->sendRequest($request);
            } catch (HttpException $e) {
                $response = $e->getResponse();
                throw new ApiException(
                    sprintf(
                        '[%d] Error connecting to the API (%s)',
                        $response->getStatusCode(),
                        (string) $request->getUri()
                    ),
                    $request,
                    $response,
                    $e
                );
            } catch (ClientExceptionInterface $e) {
                throw new ApiException(
                    sprintf('[%d] %s', $e->getCode(), $e->getMessage()),
                    $request,
                    null,
                    $e
                );
            }

            $statusCode = $response->getStatusCode();


            return [null, $statusCode, $response->getHeaders()];
        } catch (ApiException $apiException) {
            switch ($apiException->getCode()) {
                case 400:
                    $data = ObjectSerializer::deserialize(
                        $apiException->getResponseBody(),
                        \Toppy\Sendcloud\Model\ScPublicV2ScpPostFinalizeBox400Response::class,
                        $apiException->getResponseHeaders()
                    );
                    $apiException->setResponseObject($data);
                    throw $apiException;
                case 404:
                    $data = ObjectSerializer::deserialize(
                        $apiException->getResponseBody(),
                        \Toppy\Sendcloud\Model\ScPublicV2OrdersGetRetrieveAListOfShipments404Response::class,
                        $apiException->getResponseHeaders()
                    );
                    $apiException->setResponseObject($data);
                    throw $apiException;
            }
        

            throw $apiException;
        }
    }

    /**
     * Operation scPublicV2OrdersPostDeleteAShipmentAsync
     *
     * Delete a shipment
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ScPublicV2OrdersPostDeleteAShipmentRequest $scPublicV2OrdersPostDeleteAShipmentRequest You must provide either a shipment_uuid or the combination of external_order_id and external_shipment_id to this endpoint. (optional)
     *
     * @throws \InvalidArgumentException
     * @return Promise
     */
    public function scPublicV2OrdersPostDeleteAShipmentAsync($id, $scPublicV2OrdersPostDeleteAShipmentRequest = null)
    {
        return $this->scPublicV2OrdersPostDeleteAShipmentAsyncWithHttpInfo($id, $scPublicV2OrdersPostDeleteAShipmentRequest)
            ->then(
                function ($response) {
                    return $response[0];
                }
            );
    }

    /**
     * Operation scPublicV2OrdersPostDeleteAShipmentAsyncWithHttpInfo
     *
     * Delete a shipment
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ScPublicV2OrdersPostDeleteAShipmentRequest $scPublicV2OrdersPostDeleteAShipmentRequest You must provide either a shipment_uuid or the combination of external_order_id and external_shipment_id to this endpoint. (optional)
     *
     * @throws \InvalidArgumentException
     * @return Promise
     */
    public function scPublicV2OrdersPostDeleteAShipmentAsyncWithHttpInfo($id, $scPublicV2OrdersPostDeleteAShipmentRequest = null)
    {
        $request = $this->scPublicV2OrdersPostDeleteAShipmentRequest($id, $scPublicV2OrdersPostDeleteAShipmentRequest);

        return $this->httpAsyncClient->sendAsyncRequest($request)
            ->then(
                function ($response) {
                    return [null, $response->getStatusCode(), $response->getHeaders()];
                },
                function (HttpException $httpException) {
                    $response = $httpException->getResponse();
                    $statusCode = $response->getStatusCode();
                    throw new ApiException(
                        sprintf(
                            '[%d] Error connecting to the API (%s)',
                            $statusCode,
                            $httpException->getRequest()->getUri()
                        ),
                        $httpException->getRequest(),
                        $httpException->getResponse(),
                        $httpException
                    );
                }
            );
    }

    /**
     * Create request for operation 'scPublicV2OrdersPostDeleteAShipment'
     *
     * @param  int $id An id of an integration to which the shipments belong (required)
     * @param  \Toppy\Sendcloud\Model\ScPublicV2OrdersPostDeleteAShipmentRequest $scPublicV2OrdersPostDeleteAShipmentRequest You must provide either a shipment_uuid or the combination of external_order_id and external_shipment_id to this endpoint. (optional)
     *
     * @throws \InvalidArgumentException
     * @return RequestInterface
     */
    public function scPublicV2OrdersPostDeleteAShipmentRequest($id, $scPublicV2OrdersPostDeleteAShipmentRequest = null)
    {
        // verify the required parameter 'id' is set
        if ($id === null || (is_array($id) && $id === [])) {
            throw new \InvalidArgumentException(
                'Missing the required parameter $id when calling scPublicV2OrdersPostDeleteAShipment'
            );
        }

        $resourcePath = '/integrations/{id}/shipments/delete';
        $formParams = [];
        $queryParams = [];
        $headerParams = [];
        $httpBody = null;
        $multipart = false;



        // path params
        $resourcePath = str_replace(
            '{id}',
            ObjectSerializer::toPathValue($id),
            $resourcePath
        );


        $headers = $this->headerSelector->selectHeaders(
            ['application/json'],
            'application/json',
            $multipart
        );

        // for model (json/xml)
        if (isset($scPublicV2OrdersPostDeleteAShipmentRequest)) {
            if ($this->headerSelector->isJsonMime($headers['Content-Type'])) {
                $httpBody = json_encode(ObjectSerializer::sanitizeForSerialization($scPublicV2OrdersPostDeleteAShipmentRequest));
            } else {
                $httpBody = $scPublicV2OrdersPostDeleteAShipmentRequest;
            }
        } elseif ($formParams !== []) {
            if ($multipart) {
                $multipartContents = [];
                foreach ($formParams as $formParamName => $formParamValue) {
                    $formParamValueItems = is_array($formParamValue) ? $formParamValue : [$formParamValue];
                    foreach ($formParamValueItems as $formParamValueItem) {
                        $multipartContents[] = [
                            'name' => $formParamName,
                            'contents' => $formParamValueItem
                        ];
                    }
                }

                // for HTTP post (form)
                $httpBody = new MultipartStream($multipartContents);

            } elseif ($this->headerSelector->isJsonMime($headers['Content-Type'])) {
                $httpBody = json_encode($formParams);

            } else {
                // for HTTP post (form)
                $httpBody = ObjectSerializer::buildQuery($formParams);
            }
        }

        // this endpoint requires HTTP basic authentication
        if (!empty($this->config->getUsername()) || !(empty($this->config->getPassword()))) {
            $headers['Authorization'] = 'Basic ' . base64_encode($this->config->getUsername() . ":" . $this->config->getPassword());
        }

        $defaultHeaders = [];
        if ($this->config->getUserAgent()) {
            $defaultHeaders['User-Agent'] = $this->config->getUserAgent();
        }

        $headers = array_merge(
            $defaultHeaders,
            $headerParams,
            $headers
        );

        $operationHost = $this->config->getHost();

        $uri = $this->createUri($operationHost, $resourcePath, $queryParams);

        return $this->createRequest('POST', $uri, $headers, $httpBody);
    }


    /**
     * @param string|UriInterface $uri
     * @param string[] $headers
     * @param string|StreamInterface|null $body
     *
     */
    protected function createRequest(string $method, $uri, array $headers = [], $body = null): RequestInterface
    {
        if ($this->requestFactory instanceof RequestFactory) {
            return $this->requestFactory->createRequest(
                $method,
                $uri,
                $headers,
                $body
            );
        }

        if (is_string($body) && '' !== $body && null === $this->streamFactory) {
            throw new \RuntimeException('Cannot create request: A stream factory is required to create a request with a non-empty string body.');
        }

        $request = $this->requestFactory->createRequest($method, $uri);

        foreach ($headers as $key => $value) {
            $request = $request->withHeader($key, $value);
        }

        if (null !== $body && '' !== $body) {
            return $request->withBody(
                is_string($body) ? $this->streamFactory->createStream($body) : $body
            );
        }

        return $request;
    }

    /**
     * @param bool[]|\DateTime[]|int[]|string[] $queryParams
     */
    private function createUri(
        string $operationHost,
        string $resourcePath,
        array $queryParams
    ): UriInterface {
        $parsedUrl = parse_url($operationHost);

        $host = $parsedUrl['host'] ?? null;
        $scheme = $parsedUrl['scheme'] ?? null;
        $basePath = $parsedUrl['path'] ?? null;
        $port = $parsedUrl['port'] ?? null;
        $user = $parsedUrl['user'] ?? null;
        $password = $parsedUrl['pass'] ?? null;

        $uri = $this->uriFactory->createUri($basePath . $resourcePath)
            ->withHost($host)
            ->withScheme($scheme)
            ->withPort($port)
            ->withQuery(ObjectSerializer::buildQuery($queryParams));

        if ($user) {
            return $uri->withUserInfo($user, $password);
        }

        return $uri;
    }

    /**
     * @return array<int, object|int|mixed[]|null>
     */
    private function handleResponseWithDataType(
        string $dataType,
        RequestInterface $request,
        ResponseInterface $response
    ): array {
        if ($dataType === '\SplFileObject') {
            $content = $response->getBody(); //stream goes to serializer
        } else {
            $content = (string) $response->getBody();
            if ($dataType !== 'string') {
                try {
                    $content = json_decode($content, false, 512, JSON_THROW_ON_ERROR);
                } catch (\JsonException $exception) {
                    throw new ApiException(
                        sprintf(
                            'Error JSON decoding server response (%s)',
                            $request->getUri()
                        ),
			$request,
                        $response,
                        $exception
                    );
                }
            }
        }

        return [
            ObjectSerializer::deserialize($content, $dataType, []),
            $response->getStatusCode(),
            $response->getHeaders()
        ];
    }
}
